from scrapers.dca import scrape_dca_wait
from db.save import save_rows
import os

def main():
    # Get Neon connection string (GitHub Actions will supply this)
    conn_string = os.environ.get("NEON_CONN_STRING")
    if not conn_string:
        raise RuntimeError("NEON_CONN_STRING environment variable not set.")

    # ---- DCA ----
    dca_rows = scrape_dca_wait()
    save_rows(dca_rows, conn_string)

    # ---- Future airports go here ----
    # from scrapers.iad import scrape_iad_wait
    # iad_rows = scrape_iad_wait()
    # save_rows(iad_rows, conn_string)

    # from scrapers.bwi import scrape_bwi_wait
    # bwi_rows = scrape_bwi_wait()
    # save_rows(bwi_rows, conn_string)

    print("All scrapers completed successfully.")

if __name__ == "__main__":
    main()
